<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Adapters | Hitchy ODM Manual</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="">
    <link rel="preload" href="/plugin-odem/assets/css/0.styles.d0a01489.css" as="style"><link rel="preload" href="/plugin-odem/assets/js/app.24894a6b.js" as="script"><link rel="preload" href="/plugin-odem/assets/js/2.7d4a51fd.js" as="script"><link rel="preload" href="/plugin-odem/assets/js/7.35e6e637.js" as="script"><link rel="prefetch" href="/plugin-odem/assets/js/10.4b27fc1e.js"><link rel="prefetch" href="/plugin-odem/assets/js/11.ab8e9eaa.js"><link rel="prefetch" href="/plugin-odem/assets/js/12.5b873c4e.js"><link rel="prefetch" href="/plugin-odem/assets/js/13.cfc1bd4a.js"><link rel="prefetch" href="/plugin-odem/assets/js/14.8f84e832.js"><link rel="prefetch" href="/plugin-odem/assets/js/15.4e9fd0ba.js"><link rel="prefetch" href="/plugin-odem/assets/js/16.9e6bd7a1.js"><link rel="prefetch" href="/plugin-odem/assets/js/3.b9930c6f.js"><link rel="prefetch" href="/plugin-odem/assets/js/4.b5cfd9a3.js"><link rel="prefetch" href="/plugin-odem/assets/js/5.0faf965a.js"><link rel="prefetch" href="/plugin-odem/assets/js/6.6606452d.js"><link rel="prefetch" href="/plugin-odem/assets/js/8.91fa2862.js"><link rel="prefetch" href="/plugin-odem/assets/js/9.69d740b7.js">
    <link rel="stylesheet" href="/plugin-odem/assets/css/0.styles.d0a01489.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/plugin-odem/" class="home-link router-link-active"><!----> <span class="site-name">Hitchy ODM Manual</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/plugin-odem/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/plugin-odem/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><span class="title">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/plugin-odem/api/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/plugin-odem/api/adapter.html" class="nav-link router-link-exact-active router-link-active">
  Adapter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Hitchy" class="dropdown-title"><span class="title">Hitchy</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://hitchyjs.github.io/core/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Core
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>
          
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/plugin-odem/" class="nav-link">
  Odem
</a></li><li class="dropdown-subitem"><a href="https://hitchyjs.github.io/plugin-auth/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Auth
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <a href="https://github.com/hitchyjs/plugin-odem" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/plugin-odem/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/plugin-odem/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><span class="title">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/plugin-odem/api/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/plugin-odem/api/adapter.html" class="nav-link router-link-exact-active router-link-active">
  Adapter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Hitchy" class="dropdown-title"><span class="title">Hitchy</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://hitchyjs.github.io/core/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Core
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><h4>
          
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/plugin-odem/" class="nav-link">
  Odem
</a></li><li class="dropdown-subitem"><a href="https://hitchyjs.github.io/plugin-auth/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Auth
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <a href="https://github.com/hitchyjs/plugin-odem" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Adapters</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/plugin-odem/api/adapter.html#available-adapters" class="sidebar-link">Available Adapters</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/plugin-odem/api/adapter.html#storing-data-in-volatile-memory" class="sidebar-link">Storing Data in Volatile Memory</a></li><li class="sidebar-sub-header"><a href="/plugin-odem/api/adapter.html#storing-data-in-local-filesystem" class="sidebar-link">Storing Data in Local Filesystem</a></li><li class="sidebar-sub-header"><a href="/plugin-odem/api/adapter.html#storing-data-in-etcd-cluster" class="sidebar-link">Storing Data in Etcd Cluster</a></li></ul></li><li><a href="/plugin-odem/api/adapter.html#configuring-default-adapter" class="sidebar-link">Configuring Default Adapter</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="adapters"><a href="#adapters" class="header-anchor">#</a> Adapters</h1> <p>Models are relying on <em>adapters</em> for accessing its data in a connected data storage. When defining a model an adapter may be provided to use for all instances of resulting model instead of some default adapter.</p> <p>This document is about those adapters, how to use them and how to create one yourself.</p> <h2 id="available-adapters"><a href="#available-adapters" class="header-anchor">#</a> Available Adapters</h2> <p>There are two adapters distributed as part of hitchy-plugin-odem and exposed as service components:</p> <ul><li><a href="#storing-data-in-volatile-memory"><strong>OdemAdapterMemory</strong></a> is storing data in volatile memory</li> <li><a href="#storing-data-in-local-filesystem"><strong>OdemAdapterFile</strong></a> is storing data in local filesystem</li></ul> <p>In addition, separate plugins are capable of providing additional adapters, just like:</p> <ul><li><a href="#storing-data-in-etcd-cluster">hitchy-plugin-odem-etcd</a> us adding support for storing data in an etcd-based cluster.</li></ul> <p>Adapters are exposing an API very similar to the one of LevelDB. That's why it is possible to write your own adapter for saving records in a key-value-store like LevelDB.</p> <h3 id="storing-data-in-volatile-memory"><a href="#storing-data-in-volatile-memory" class="header-anchor">#</a> Storing Data in Volatile Memory</h3> <p>The service component <strong>OdemAdapterMemory</strong> of Hitchy's ODM is an adapter most useful for developing and testing applications as it doesn't actually save any data but manages records in volatile memory, only.</p> <p>Creating instances doesn't take any options. Different instances manage different sets of records, so it's even possible to have different sets of data separately managed in volatile memory.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>services<span class="token punctuation">.</span>OdemAdapterMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This adapter may be provided on calling <code>Model.define()</code> explicitly. In a default setup it is also used whenever omitting provision of adapter on calling that function.</p> <h3 id="storing-data-in-local-filesystem"><a href="#storing-data-in-local-filesystem" class="header-anchor">#</a> Storing Data in Local Filesystem</h3> <p>This adapter is meant to implement a very basic opportunity to persistently save records without relying on any additional software. It is thus suitable for smaller, single-node applications e.g. desktop software based on <a href="https://www.electronjs.org/" target="_blank" rel="noopener noreferrer">Electron<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>When using it all records are saved in a folder of your local filesystem. That's why you should provide the path name of folder to contain all those files as option on creating instances of <strong>OdemAdapterFile</strong>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>services<span class="token punctuation">.</span>OdemAdapterFile</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
   dataSource<span class="token operator">:</span> <span class="token string">&quot;/path/name/of/a/folder&quot;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="storing-data-in-etcd-cluster"><a href="#storing-data-in-etcd-cluster" class="header-anchor">#</a> Storing Data in Etcd Cluster</h3> <p>Separate plugin <a href="https://www.npmjs.com/package/hitchy-plugin-odem-etcd" target="_blank" rel="noopener noreferrer">hitchy-plugin-odem-etcd<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> enables data being persisted in an etcd cluster, too. This option is intended for use with production setups running in a cluster enabling horizontal scaling of your Hitchy application.</p> <p>See the plugin's documentation for up-to-date information on how to integrate it with your application. The following excerpt is meant to demonstrate the ease of integrating Odem with etcd cluster instead of some local filesystem, only:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">api<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>services<span class="token punctuation">.</span>OdemAdapterEtcd</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
    hosts<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;https://etcd1:2379&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;https://etcd2:2379&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;https://etcd3:2379&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// optional: share single etcd cluster with multiple apps</span>
    prefix<span class="token operator">:</span> <span class="token string">&quot;/apps/my-app&quot;</span><span class="token punctuation">,</span>
    auth<span class="token operator">:</span> <span class="token punctuation">{</span>
        username<span class="token operator">:</span> <span class="token string">&quot;etcd-login-user&quot;</span><span class="token punctuation">,</span>
        password<span class="token operator">:</span> <span class="token string">&quot;secret-pw&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// optional: authenticate server and client on encrypted connections</span>
    credentials<span class="token operator">:</span> <span class="token punctuation">{</span>
        rootCertificate<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">&quot;fs&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span> <span class="token string">&quot;path/to/ca.pem&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
        certChain<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">&quot;fs&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span> <span class="token string">&quot;path/to/cert.pem&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
        privateKey<span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">&quot;fs&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span> <span class="token string">&quot;path/to/key.pem&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="configuring-default-adapter"><a href="#configuring-default-adapter" class="header-anchor">#</a> Configuring Default Adapter</h2> <p>In compliance with Hitchy's conventions you may create a file <strong>config/database.js</strong> in your Hitchy-based project's folder with content like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> File <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span> <span class="token string">&quot;fs&quot;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        database<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token keyword">default</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>services<span class="token punctuation">.</span>OdemAdapterFile</span><span class="token punctuation">(</span> <span class="token punctuation">{</span>
                dataSource<span class="token operator">:</span> <span class="token string">&quot;/path/name/of/a/folder&quot;</span>
            <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>This example is replacing the default adapter storing all data in volatile memory with another adapter storing all data in a folder of your local filesystem.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/plugin-odem/api/model.html" class="prev">
        Model API
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/plugin-odem/assets/js/app.24894a6b.js" defer></script><script src="/plugin-odem/assets/js/2.7d4a51fd.js" defer></script><script src="/plugin-odem/assets/js/7.35e6e637.js" defer></script>
  </body>
</html>
